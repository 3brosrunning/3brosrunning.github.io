  <!-- PapaParse for CSV parsing -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <script>
    function getHighlightClass(years, maxYears) {
      if (years === maxYears) return "highlight-most-years";
      if (years >= 10) return "highlight-10plus";
      if (years >= 5) return "highlight-5plus";
      return "";
    }

    function renderRunners(data) {
      const runnerList = document.getElementById("runnerList");
      runnerList.innerHTML = "";

      const yearsList = data
        .map(r => parseInt(r.Years))
        .filter(y => !isNaN(y));
      const maxYears = Math.max(...yearsList);

      data.forEach(runner => {
        const years = parseInt(runner.Years);

        // Build full name depending on CSV format
        let fullName = "";
        if (runner.Name) {
          // If there's a single Name column
          fullName = runner.Name.trim();
        } else if (runner.First || runner.Last) {
          // If using "First" and "Last"
          const firstName = (runner.First || "").trim();
          const lastName = (runner.Last || "").trim();
          fullName = `${firstName} ${lastName}`.trim();
        } else {
          // Fallback for "First Name" + "Last Name"
          const firstName = (runner["First Name"] || "").trim();
          const lastName = (runner["Last Name"] || "").trim();
          fullName = `${firstName} ${lastName}`.trim();
        }

        if (!fullName || isNaN(years)) return;

        const card = document.createElement("div");
        card.className = `runner-card ${getHighlightClass(years, maxYears)}`;
        card.setAttribute("data-years", years);
        card.style.paddingTop = "30px";
        card.innerHTML = `
          <p class="runner-name">${fullName}</p>
          <p class="runner-count">${years} years</p>
        `;
        runnerList.appendChild(card);
      });
    }

    // Load CSV (make sure runnerskemah.csv is in the same folder as this HTML file)
    Papa.parse("runnerskemah.csv?v=" + new Date().getTime(), {
      download: true,
      header: true,
      complete: function(results) {
        renderRunners(results.data);
      }
    });

    // Search filter
    document.getElementById("runnerSearch").addEventListener("input", function() {
      const term = this.value.toLowerCase();
      document.querySelectorAll(".runner-card").forEach(card => {
        const name = card.querySelector(".runner-name").innerText.toLowerCase();
        card.style.display = name.includes(term) ? "" : "none";
      });
    });
  </script>
